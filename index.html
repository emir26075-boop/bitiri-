<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Restoran Sipariş Sistemi</title>
  <link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background:#f0f0f0; }
    nav { display: flex; gap: 10px; margin-bottom: 20px; }
    nav button { padding: 10px; cursor: pointer; }
    .tab { display: none; }
    .tab.active { display: block; }
    .menu-item { border:1px solid #ccc; border-radius:10px; padding:10px; text-align:center; background:#fff; }
    .btn { padding:5px 10px; background:#f97316; color:white; border:none; border-radius:5px; cursor:pointer; margin-top:5px; }
    #menuList { display: grid; grid-template-columns: repeat(3, 1fr); gap:15px; }
    #cart { flex:1; background:#fff; padding:10px; border-radius:10px; max-height:500px; overflow-y:auto; }
    .cart-item { margin-bottom:5px; }
  </style>
</head>
<body>
  <h1>Restoran Sipariş Sistemi</h1>
  <nav>
    <button onclick="showTab('menu')" class="active">Menü</button>
    <button onclick="showTab('orders')">Alınan Siparişler</button>
    <button onclick="showTab('completed')">Çıkan Siparişler</button>
  </nav>

  <!-- Menü ve Sepet -->
  <div id="menu" class="tab active">
    <label>Masa / Bölge: <input id="masaInput" /></label>
    <div style="display:flex; gap:20px;">
      <div id="menuList"></div>
      <div id="cart">
        <h3>Sepet</h3>
        <div id="cartItems"></div>
        <div><b>Toplam: </b><span id="cartTotal">0</span>₺</div>
        <button class="btn" onclick="createOrder()">Siparişi Onayla</button>
      </div>
    </div>
  </div>

  <div id="orders" class="tab">
    <h2>Alınan Siparişler</h2>
    <div id="ordersList"></div>
  </div>

  <div id="completed" class="tab">
    <h2>Çıkan Siparişler</h2>
    <div id="completedList"></div>
  </div>

<script>
const menu = [
  { ad: "Çiğ köfte 5 parça", fiyat: 1500 },
  { ad: "Çiğ köfte 10 parça", fiyat: 3000 },
  { ad: "Çiğ köfte 15 parça", fiyat: 4000 },
  { ad: "Çiğ köfte 21 parça", fiyat: 5000 },
  { ad: "Normal dürüm", fiyat: 1500 },
  { ad: "Doritoslu dürüm", fiyat: 2000 },
  { ad: "Çiğ köfte suşi yarım", fiyat: 2500 },
  { ad: "Çiğ köfte suşi tam", fiyat: 5000 },
  { ad: "Doritoslu suşi yarım", fiyat: 3500 },
  { ad: "Doritoslu suşi tam", fiyat: 7000 },
  { ad: "Tavuklu pilav", fiyat: 2500 },
  { ad: "Ekstra tavuk", fiyat: 1000 },
  { ad: "Sade pilav", fiyat: 2000 },
  { ad: "Köfte pilav", fiyat: 5000 },
  { ad: "Ekstra köfte", fiyat: 1000 },
  { ad: "Köfte ekmek", fiyat: 3000 },
  { ad: "Köfte lavaş", fiyat: 3000 },
  { ad: "Ayran", fiyat: 500 },
  { ad: "Pepsi", fiyat: 500 },
  { ad: "Pepsi Diet", fiyat: 500 },
  { ad: "Dyo", fiyat: 500 },
  { ad: "Sprite", fiyat: 500 },
  { ad: "Miranda", fiyat: 500 },
  { ad: "Su", fiyat: 250 },
];

let cart = [];
let orders = JSON.parse(localStorage.getItem("orders") || "[]");
let completedOrders = JSON.parse(localStorage.getItem("completedOrders") || "[]");

function showTab(id) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function renderMenu() {
  const list = document.getElementById("menuList");
  list.innerHTML = "";
  menu.forEach((m,i)=>{
    const div = document.createElement("div");
    div.className="menu-item";
    div.innerHTML = `
      <div>${m.ad}</div>
      <div>${m.fiyat}₺</div>
      <input type="number" min="1" value="1" id="qty-${i}" style="width:50px;"/>
      <button class="btn" onclick="addToCart(${i})">Sepete Ekle</button>
    `;
    list.appendChild(div);
  });
}

function addToCart(i){
  const qty = parseInt(document.getElementById(`qty-${i}`).value) || 1;
  const existing = cart.find(it=>it.ad===menu[i].ad);
  if(existing){ existing.adet += qty; } 
  else{ cart.push({ad:menu[i].ad,fiyat:menu[i].fiyat,adet:qty}); }
  renderCart();
}

function renderCart(){
  const container=document.getElementById("cartItems");
  container.innerHTML="";
  let total=0;
  cart.forEach((item,index)=>{
    total += item.fiyat*item.adet;
    const div=document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`${item.ad} - ${item.adet} adet - ${item.fiyat*item.adet}₺ <button onclick="removeCartItem(${index})">X</button>`;
    container.appendChild(div);
  });
  document.getElementById("cartTotal").textContent=total;
}

function removeCartItem(index){ cart.splice(index,1); renderCart(); }

function createOrder(){
  const masa=document.getElementById("masaInput").value||"Bilinmiyor";
  if(cart.length===0){ alert("Sepet boş!"); return; }
  const siparis={masa,items:[...cart],zaman:new Date().toLocaleTimeString()};
  orders.push(siparis);
  localStorage.setItem("orders",JSON.stringify(orders));
  cart=[];
  renderCart();
  renderOrders();
  alert("Sipariş alındı!");
}

function renderOrders(){
  const container=document.getElementById("ordersList");
  container.innerHTML="";
  orders.forEach((o,i)=>{
    const div=document.createElement("div");
    div.innerHTML=`Masa: ${o.masa} - ${o.items.map(it=>it.ad+" x"+it.adet).join(", ")} (${o.zaman})
      <button class="btn" onclick="completeOrder(${i})">Çıktı</button>`;
    container.appendChild(div);
  });
}

function completeOrder(i){
  const o=orders.splice(i,1)[0];
  completedOrders.push(o);
  localStorage.setItem("orders",JSON.stringify(orders));
  localStorage.setItem("completedOrders",JSON.stringify(completedOrders));
  renderOrders();
  renderCompleted();
}

function renderCompleted(){
  const container=document.getElementById("completedList");
  container.innerHTML="";
  completedOrders.forEach(o=>{
    const div=document.createElement("div");
    div.innerHTML=`Masa: ${o.masa} - ${o.items.map(it=>it.ad+" x"+it.adet).join(", ")} (${o.zaman})`;
    container.appendChild(div);
  });
}

renderMenu(); renderCart(); renderOrders(); renderCompleted();
</script>
</body>
</html>
